<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proceso de Pago | SUBASTEC</title>
    <link rel="stylesheet" href="/css/Proceso de pago.css">
</head>

<body>

    <!-- Encabezado -->
    <header>
        <div class="logo">
            <img src="/images/3b288cc5-5872-4167-8fe9-fe8ddbf34fbe-removebg-preview.png" alt="SUBASTEC Logo"
                class="logo-img">
        </div>
        <div class="nav-links">
            <input type="text" placeholder="Buscar productos..." class="search-bar">
            <a href="/Pagina de inicio.html"><button class="nav-btn">Inicio</button></a>
            <a href="/Quienessomos.html"><button class="nav-btn">Quienes somos</button></a>
            <a href="/Tienda.html"><button class="nav-btn">Tienda</button></a>
            <a href="/Notificaciones.html"><button class="nav-btn">Notificaciones</button></a>
            <a href="/Login.html"><button class="nav-btn login-btn">Ingresar</button></a>
        </div>
    </header>

    <div class="payment-container">
        <h2>Proceso de Pago</h2>
        <div class="payment-summary">
            <h3>Resumen de la Compra</h3>
            <ul id="productos-resumen">
                <!-- Aquí se agregarán los productos dinámicamente -->
            </ul>
            <p id="total-resumen">Total: <strong>$0</strong></p>
        </div>


        <form id="paymentForm" action="/procesar-pago" method="POST">
            <div class="form-group">
                <label for="cardNumber">Número de Tarjeta *</label>
                <input type="text" id="cardNumber" name="tarjeta" placeholder="1234 5678 9012 3456" maxlength="16"
                    required>
            </div>

            <div class="form-group">
                <label for="name">Nombre y Apellido *</label>
                <input type="text" id="name" name="nombre_apellido" placeholder="Ej: Juan Pérez" required>
            </div>

            <div class="form-group form-row">
                <div class="form-half">
                    <label for="expiry">Expiración (MM/AA)</label>
                    <input type="text" id="expiry" name="expiracion" placeholder="MM/AA" maxlength="5" required>
                </div>
                <div class="form-half">
                    <label for="cvv">CVV *</label>
                    <input type="password" id="cvv" name="cvv" placeholder="123" maxlength="3" required>
                </div>
            </div>

            <div class="form-group">
                <label for="amount">Número de Cuotas</label>
                <select id="amount" name="cuotas" required>
                    <option value="1">1 cuota</option>
                    <option value="3">3 cuotas</option>
                    <option value="6">6 cuotas</option>
                    <option value="12">12 cuotas</option>
                </select>
            </div>

            <div class="form-group">
                <label for="documentType">Tipo de Documento *</label>
                <select id="documentType" name="tipo_documento" required>
                    <option value="DNI">DNI</option>
                    <option value="CE">Carné de Extranjería</option>
                    <option value="RUC">RUC</option>
                </select>
            </div>

            <div class="form-group">
                <label for="documentNumber">Número de Documento *</label>
                <input type="text" id="documentNumber" name="numero_documento" placeholder="Ej: 12345678" maxlength="12"
                    required>
            </div>

            <button class="button2" type="submit">Realizar Pago</button>
        </form>
        <div id="paymentMessage"></div>

        <a href="/Frontend/Subastas.html" class="boton-regresar">Regresar</a>
    </div>

    <!-- Botón de WhatsApp -->
    <div class="floating-whatsapp">
        <a href="https://wa.me/1234567890" target="_blank">
            <img src="/images/logo1.png" alt="Logo" class="logo-img">
        </a>
    </div>


    <footer class="footer">
        <div class="footer-container">
            <!-- Sección Sobre Nosotros -->
            <div class="footer-about">
                <h3>Sobre Subastec</h3>
                <p> Somos una plataforma líder en ventas en línea que conecta
                    a compradores en todo el mundo para obtener productos
                    exclusivos a precios increibles.</p>
            </div>

            <!-- Enlaces rápidos -->
            <div class="footer-links">
                <h3>Enlaces Rápidos</h3>
                <ul>
                    <li><a href="/Pagina de inicio.html">Inicio</a></li>
                    <li><a href="/Quienessomos.html">Quienes Somos</a></li>
                    <li><a href="/Subastas.html">Subastas</a></li>
                    <li><a href="/Notificaciones.html">Notificaciones</a></li>
                    <li><a href="/Login.html">Ingresar</a></li>
                </ul>
            </div>

            <!-- Información de contacto -->
            <div class="footer-contact">
                <h3>Contáctanos</h3>
                <p><strong>Teléfono:</strong> 935 826 637</p>
                <p><strong>Email:</strong> soporte@subastec.com</p>
                <p><strong>Dirección:</strong> Av.San Juan 123, Lima , Peru</p>
            </div>

            <!-- Redes Sociales -->
            <div class="footer-social">
                <h3>Síguenos</h3>
                <div class="social-icons">
                    <!-- Enlace a Facebook -->
                    <a href="https://www.facebook.com" target="_blank" rel="noopener noreferrer">
                        <img src="/images/logo3.png" alt="Facebook">
                    </a>

                    <!-- Enlace a Twitter -->
                    <a href="https://www.twitter.com" target="_blank" rel="noopener noreferrer">
                        <img src="/images/logo4.png" alt="Twitter">
                    </a>

                    <!-- Enlace a Instagram -->
                    <a href="https://www.instagram.com" target="_blank" rel="noopener noreferrer">
                        <img src="/images/logo2.png" alt="Instagram">
                    </a>

                    <!-- Enlace a WhatsApp -->
                    <a href="https://wa.me/1234567890" target="_blank" rel="noopener noreferrer">
                        <img src="/images/logo4.png" alt="WhatsApp">
                    </a>
                </div>
            </div>
        </div>

        <!-- Sección de Derechos Reservados -->
        <div class="footer-bottom">
            <p>&copy; 2024 Subastec. Todos los derechos reservados. | <a href="/public/terminos.html">Términos y
                    Condiciones</a> | <a href="/Frontend/politica.html">Política de Privacidad</a></p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', cargarResumenDeCompra);

        function cargarResumenDeCompra() {
            const productosResumen = document.getElementById('productos-resumen');
            const totalResumen = document.getElementById('total-resumen');

            // Obtener productos del carrito desde el localStorage
            const productosCarrito = JSON.parse(localStorage.getItem('carrito')) || [];

            // Limpiar la lista actual
            productosResumen.innerHTML = '';

            let total = 0;

            // Si hay productos en el carrito, agregar a la lista
            productosCarrito.forEach(producto => {
                // Crear elemento de lista
                const item = document.createElement('li');
                item.textContent = `${producto.titulo} - ${producto.precio}`;
                productosResumen.appendChild(item);

                // Calcular el total
                let precioProducto = producto.precio.replace(/[^0-9,-]+/g, "");
                total += parseFloat(precioProducto.replace(",", ""));
            });

            // Actualizar el total en pantalla
            totalResumen.innerHTML = `Total: <strong>S/.${total.toFixed(2)}</strong>`;
        }
    </script>

    <script>
        // Cuando el usuario haga clic en "Proceder al Pago"
        document.getElementById('btn-comprar').addEventListener('click', function () {
            // Vaciar el carrito en localStorage solo al proceder al pago
            localStorage.removeItem('carrito');

            // Mostrar mensaje de pago procesado satisfactoriamente
            alert('Pago procesado correctamente. ¡Gracias por tu compra!');

            // Redirigir a la página de pago o confirmación de pago
            window.location.href = '/proceso-de-pago';  // Redirige a la página de pago
        });
    </script>

    <script>
        function agregarAlCarrito(producto) {
            const carrito = JSON.parse(localStorage.getItem('carrito')) || [];

            // Verificar si el producto ya existe en el carrito
            const index = carrito.findIndex(item => item.id === producto.id);
            if (index === -1) {
                carrito.push(producto);  // Si no está, agregarlo
            } else {
                carrito[index].cantidad += 1;  // Si ya existe, solo aumentar la cantidad
            }

            // Guardar el carrito en localStorage
            localStorage.setItem('carrito', JSON.stringify(carrito));
        }
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Recuperar el producto desde localStorage
            const producto = JSON.parse(localStorage.getItem('productoSeleccionado'));

            if (producto) {
                const listaProductos = document.getElementById('productos-resumen');
                const totalResumen = document.getElementById('total-resumen');

                // Limpiar el resumen de productos
                listaProductos.innerHTML = '';

                // Crear el elemento de lista para el producto
                const productoItem = document.createElement('li');
                productoItem.textContent = `${producto.nombre} - ${producto.precio}`;
                listaProductos.appendChild(productoItem);

                // Asegurarse de que el precio es un número antes de calcular
                let total = parseFloat(producto.precio); // Convertir el precio a número flotante

                if (isNaN(total)) {
                    total = 0; // Si no se pudo convertir a número, asignar 0
                }

                // Quitar los decimales
                total = Math.floor(total); // O puedes usar parseInt(total)

                // Actualizar el total en pantalla
                totalResumen.innerHTML = `Total: <strong>${producto.precio}</strong>`;
            } else {
                console.error('No se encontró el producto en el localStorage.');
            }


            // Al confirmar el pago, eliminar el producto del localStorage
            confirmarPago.addEventListener('click', function () {
                // Eliminar el producto de localStorage
                localStorage.removeItem('productoSeleccionado');
                alert("Pago confirmado, gracias por su compra.");

                // Redirigir a una página de confirmación o de inicio
                window.location.href = "/pagina-de-confirmacion.html";
            });


        });

        // Escuchar cuando la página esté siendo cargada desde el historial (cuando el usuario retrocede)
        window.addEventListener('pageshow', function (event) {
            // Eliminar los datos del producto al retroceder
            localStorage.removeItem('productoSeleccionado');
        });

    </script>




    <script src="script.js"></script>
</body>

</html>